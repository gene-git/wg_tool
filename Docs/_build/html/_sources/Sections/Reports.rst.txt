.. SPDX-License-Identifier: GPL-2.0-or-later


.. _Reports:

Reports
=======

A Better Gateway Report.
-----------------------

The *-rpt* option reads output from the standard wireguard gateway
report generated by *wg show* and presents it in a human friendly way.

The *wg show* output uses public keys to identify each peer.
*wg-tool* looks up which profile the key belongs to which
enables it to show the same information by account and profile name.

To use this save the output of *wg show* into a file and then run

.. code-block:: bash

   wg-tool -rpt <filename>

This feature solves a long standing problem with native wireguard reports which 
burden the administrator with mapping IPs or public keys to an account.profile. 

The report also indicates if accounts / profiles seen by the gateway 
are active (or inactive) by showing (+) or (-) beside the name. 

If an inactive profile is seen on the gateway, it may be time update the gateway configs.

Because of this feature, this tool eliminates any need for complex schemes, some 
are pretty dodgy. For example, so-called Vanity keys, which attempt to search for public 
keys that are more palatable by repeatedly generating keys until one is 
found that looks it might contain a sequence of characters that is *interesting*.

Sample Report
-------------

This is a sample output taken from *wg show*:

.. code-block:: none

    interface: wg0
      public key: AAAAA...
      private key: (hidden)
      listening port: NNNNN

    peer: XXXX...
      preshared key: (hidden)
      endpoint: x.x.x.x:nnnnn
      allowed ips: 10.77.77.134/32
      latest handshake: 11 seconds ago
      transfer: 21.57 KiB received, 120.62 KiB sent

And this is the report generated from that same output 
using *wg-tool -rpt <report file>*:

.. code-block:: none

    vpn: vpn1 (+)

    servers (+)    : wg-A (+) (gateway)
         interface : wg0
      listen_port  : NNNNN
          address  : ['10.77.77.1/24', 'fc00:77:77::1/64']

    Peers using this gateway
    alice (+)      : laptop (+) 
          address  : '10.77.77.134/32'
       allowed_ips : '10.77.77.134/32'
          endpoint : x.x.x.x:nnnnn
          transfer : 21.57 KiB received, 120.62 KiB sent

A little more detail is shown when coupled with the *-det* option:

.. code-block:: none

    vpn: vpn1 (+)

    servers (+)    : wg-A (+) (gateway)
         interface : wg0
      listen_port  : NNNNN
          address  : ['10.77.77.1/24', 'fc00:77:77::1/64']
  internet_offered : True
         PublicKey : AAA...

    Peers using this gateway
    alice (+)      : laptop (+) 
          address  : '10.77.77.134/32'
       allowed_ips : '10.77.77.134/32'
          endpoint : x.x.x.x:nnnnn
          transfer : 21.57 KiB received, 120.62 KiB sent
   internet_wanted : True
         PublicKey : XXX...


