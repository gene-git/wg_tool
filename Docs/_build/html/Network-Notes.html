<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Networking Notes &#8212; wg_tool 8.0.rc2 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=27fed22d" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=e043c39a" />
    <script src="_static/documentation_options.js?v=321254cf"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="networking-notes">
<h1>Networking Notes<a class="headerlink" href="#networking-notes" title="Link to this heading">¶</a></h1>
<p>This note is an overview of wireguard networking setup. By default we assume that the wireguard
server has access to internet and any desired local services.  With this in mind, the
default <em>postup.nft</em> script NATs the wireguard network so it’s traffic to the LAN
appears to come from the wireguard server itself. We also assume that the local DNS servers
provided in wireguard configs, are available to the wireguard server - typicallu as they are on
the same LAN.</p>
<p>Edit <em>postup.nft</em> and set the variables for your network</p>
<blockquote>
<div><p>define vpn_net = 10.99.99.0/24  # must match server config
define lan_ip = 10.0.0.1        # real lan ip of wg server
define lan_iface = eno1         # lan interface
define wg = wg0</p>
</div></blockquote>
<section id="assumed-network-topology-for-default-postup-nft">
<h2>Assumed Network Topology for default postup.nft<a class="headerlink" href="#assumed-network-topology-for-default-postup-nft" title="Link to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>        <span class="o">|</span>              <span class="o">|</span>                         <span class="o">|</span>          <span class="o">|</span>               <span class="o">|</span>
<span class="p">(</span>        <span class="o">|</span>              <span class="o">|</span> <span class="p">(</span><span class="n">vpn</span><span class="o">.</span><span class="n">ip</span><span class="p">:</span><span class="mi">39001</span><span class="p">)</span>          <span class="o">|</span>          <span class="o">|</span>               <span class="o">|</span>
<span class="p">(</span>        <span class="o">|</span>    <span class="o">&lt;---&gt;</span>     <span class="o">|</span> <span class="n">pub</span><span class="o">-</span><span class="n">ip</span>           <span class="n">lan</span><span class="o">-</span><span class="n">ip</span> <span class="o">|</span> <span class="o">&lt;-</span><span class="n">NAT</span><span class="o">-&gt;</span>  <span class="o">|</span> <span class="n">lan</span><span class="o">-</span><span class="n">ip</span><span class="p">:</span><span class="mi">39001</span>  <span class="o">|</span>
<span class="p">(</span>        <span class="o">|</span>              <span class="o">|</span>                         <span class="o">|</span>          <span class="o">|</span> <span class="n">en01</span>          <span class="o">|</span>
<span class="p">(</span>        <span class="o">|</span>              <span class="o">|</span>                         <span class="o">|</span>          <span class="o">|</span>               <span class="o">|</span>
<span class="p">(</span> <span class="n">Client</span> <span class="o">|</span>   <span class="n">Internet</span>   <span class="o">|</span>       <span class="n">Firewall</span>          <span class="o">|</span>   <span class="n">LAN</span>    <span class="o">|</span>   <span class="n">WG</span> <span class="n">Server</span>   <span class="o">|</span>

<span class="o">+</span> <span class="o">---------------------------------------------------------------------------+</span>
<span class="o">|</span>     <span class="o">&lt;--&gt;</span>               <span class="n">VPN</span> <span class="n">Tunnel</span>  <span class="p">(</span><span class="mf">10.99.99</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>                <span class="o">&lt;----&gt;</span>      <span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------+</span>
</pre></div>
</div>
<p>If your network differs, then adjust the nftables postup rules as needed.</p>
<p>We also assume that there are no other nftables rules running on the wireguard server itself.
If there are then you should change the postdown rule to not flush all rules as happens by default
and instead add the rules and remove them in postdown.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">wg_tool</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="README.html">wg-tool</a></li>
<li class="toctree-l1"><a class="reference internal" href="README.html#documentation">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="README.html#getting-started">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="License/License.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="Examples.html">Working Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="Sections/Editing.html">Editing and Making Changes</a></li>
<li class="toctree-l1"><a class="reference internal" href="Sections/Options.html">Command Line Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="Sections/Reports.html">Reports</a></li>
<li class="toctree-l1"><a class="reference internal" href="Sections/Key-rollover.html">Key Rollover</a></li>
<li class="toctree-l1"><a class="reference internal" href="Sections/Helper-scripts.html">Convenience Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="Sections/Migrating.html">Migrating from Earlier Version</a></li>
<li class="toctree-l1"><a class="reference internal" href="Sections/Import.html">Importing From Standard Wireguard Configs</a></li>
<li class="toctree-l1"><a class="reference internal" href="Sections/Directory-structure.html">Directory and File Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="Sections/Appendix.html">Appendix</a></li>
<li class="toctree-l1"><a class="reference internal" href="Contrib/ubuntu.html">Contrib</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2022-2025, Gene C.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="_sources/Network-Notes.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>